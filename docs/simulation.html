<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 15 Simulation | STAT 107 Outline of Class Notes</title>
  <meta name="description" content="Course notes for UCR’s STAT 107. An introduction to programming in R." />
  <meta name="generator" content="bookdown 0.23 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 15 Simulation | STAT 107 Outline of Class Notes" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://rpkgarcia.github.io/stat107_summer2022notes/" />
  
  <meta property="og:description" content="Course notes for UCR’s STAT 107. An introduction to programming in R." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 15 Simulation | STAT 107 Outline of Class Notes" />
  
  <meta name="twitter:description" content="Course notes for UCR’s STAT 107. An introduction to programming in R." />
  

<meta name="author" content="Rebecca Kurtz-Garcia" />


<meta name="date" content="2023-03-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="loops.html"/>
<link rel="next" href="tidyverse.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="assets/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">STAT 107 Notes</a></li>

<li class="divider"></li>
<li><a href="index.html#welcome">Welcome<span></span></a></li>
<li class="chapter" data-level="1" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>1</b> Introduction to R<span></span></a><ul>
<li class="chapter" data-level="1.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#download-and-install-r-and-rstudio"><i class="fa fa-check"></i><b>1.1</b> Download and Install R and Rstudio<span></span></a></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#the-rstudio-interface"><i class="fa fa-check"></i><b>1.2</b> The <strong>RStudio</strong> Interface<span></span></a><ul>
<li><a href="introduction-to-r.html#bottom-left-pane">Bottom Left Pane<span></span></a></li>
<li><a href="introduction-to-r.html#bottom-right-pane">Bottom Right Pane<span></span></a></li>
<li><a href="introduction-to-r.html#top-right-pane">Top Right Pane<span></span></a></li>
<li><a href="introduction-to-r.html#top-left-pane">Top Left Pane<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#comments"><i class="fa fa-check"></i><b>1.3</b> Comments<span></span></a></li>
<li class="chapter" data-level="1.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#operators"><i class="fa fa-check"></i><b>1.4</b> Operators<span></span></a><ul>
<li><a href="introduction-to-r.html#arithmetic-operators">Arithmetic Operators<span></span></a></li>
<li><a href="introduction-to-r.html#relational-operators">Relational Operators<span></span></a></li>
<li><a href="introduction-to-r.html#logical-operators">Logical operators<span></span></a></li>
<li><a href="introduction-to-r.html#assignment-operators">Assignment Operators<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#naming-conventions"><i class="fa fa-check"></i><b>1.5</b> Naming Conventions<span></span></a></li>
<li class="chapter" data-level="1.6" data-path="introduction-to-r.html"><a href="introduction-to-r.html#basic-calculations"><i class="fa fa-check"></i><b>1.6</b> Basic Calculations<span></span></a></li>
<li class="chapter" data-level="1.7" data-path="introduction-to-r.html"><a href="introduction-to-r.html#floating-point-error"><i class="fa fa-check"></i><b>1.7</b> Floating Point Error<span></span></a></li>
<li><a href="introduction-to-r.html#additional-resources">Additional Resources<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="atomic-vectors.html"><a href="atomic-vectors.html"><i class="fa fa-check"></i><b>2</b> Atomic Vectors<span></span></a><ul>
<li class="chapter" data-level="2.1" data-path="atomic-vectors.html"><a href="atomic-vectors.html#examples"><i class="fa fa-check"></i><b>2.1</b> Examples<span></span></a><ul>
<li><a href="atomic-vectors.html#double">Double<span></span></a></li>
<li><a href="atomic-vectors.html#integer">Integer<span></span></a></li>
<li><a href="atomic-vectors.html#logical">Logical<span></span></a></li>
<li><a href="atomic-vectors.html#character">Character<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="atomic-vectors.html"><a href="atomic-vectors.html#basic-features"><i class="fa fa-check"></i><b>2.2</b> Basic Features<span></span></a><ul>
<li class="chapter" data-level="2.2.1" data-path="atomic-vectors.html"><a href="atomic-vectors.html#length"><i class="fa fa-check"></i><b>2.2.1</b> Length<span></span></a></li>
<li class="chapter" data-level="2.2.2" data-path="atomic-vectors.html"><a href="atomic-vectors.html#vecoperators"><i class="fa fa-check"></i><b>2.2.2</b> Vectorized Operations and Recylcing<span></span></a></li>
<li class="chapter" data-level="2.2.3" data-path="atomic-vectors.html"><a href="atomic-vectors.html#coercion"><i class="fa fa-check"></i><b>2.2.3</b> Coercion<span></span></a></li>
<li class="chapter" data-level="2.2.4" data-path="atomic-vectors.html"><a href="atomic-vectors.html#testing"><i class="fa fa-check"></i><b>2.2.4</b> Testing<span></span></a></li>
<li class="chapter" data-level="2.2.5" data-path="atomic-vectors.html"><a href="atomic-vectors.html#names"><i class="fa fa-check"></i><b>2.2.5</b> Names<span></span></a></li>
<li class="chapter" data-level="2.2.6" data-path="atomic-vectors.html"><a href="atomic-vectors.html#typeof-and-class"><i class="fa fa-check"></i><b>2.2.6</b> typeof() and class()<span></span></a></li>
<li class="chapter" data-level="2.2.7" data-path="atomic-vectors.html"><a href="atomic-vectors.html#index"><i class="fa fa-check"></i><b>2.2.7</b> Accessing Elements of a Vector<span></span></a></li>
</ul></li>
<li><a href="atomic-vectors.html#summary">Summary<span></span></a></li>
<li><a href="atomic-vectors.html#additional-resources-1">Additional Resources<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="factors-and-lists.html"><a href="factors-and-lists.html"><i class="fa fa-check"></i><b>3</b> Factors and Lists<span></span></a><ul>
<li class="chapter" data-level="3.1" data-path="factors-and-lists.html"><a href="factors-and-lists.html#factors"><i class="fa fa-check"></i><b>3.1</b> Factors<span></span></a><ul>
<li class="chapter" data-level="3.1.1" data-path="factors-and-lists.html"><a href="factors-and-lists.html#levels"><i class="fa fa-check"></i><b>3.1.1</b> Levels<span></span></a></li>
<li class="chapter" data-level="3.1.2" data-path="factors-and-lists.html"><a href="factors-and-lists.html#ordered-factor"><i class="fa fa-check"></i><b>3.1.2</b> Ordered Factor<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="factors-and-lists.html"><a href="factors-and-lists.html#factors---basic-features"><i class="fa fa-check"></i><b>3.2</b> Factors - Basic Features<span></span></a><ul>
<li class="chapter" data-level="3.2.1" data-path="factors-and-lists.html"><a href="factors-and-lists.html#length-1"><i class="fa fa-check"></i><b>3.2.1</b> Length<span></span></a></li>
<li class="chapter" data-level="3.2.2" data-path="factors-and-lists.html"><a href="factors-and-lists.html#coercion-1"><i class="fa fa-check"></i><b>3.2.2</b> Coercion<span></span></a></li>
<li class="chapter" data-level="3.2.3" data-path="factors-and-lists.html"><a href="factors-and-lists.html#testingclass"><i class="fa fa-check"></i><b>3.2.3</b> Testing/Class<span></span></a></li>
<li class="chapter" data-level="3.2.4" data-path="factors-and-lists.html"><a href="factors-and-lists.html#names-1"><i class="fa fa-check"></i><b>3.2.4</b> Names<span></span></a></li>
<li class="chapter" data-level="3.2.5" data-path="factors-and-lists.html"><a href="factors-and-lists.html#accessing-elements"><i class="fa fa-check"></i><b>3.2.5</b> Accessing Elements<span></span></a></li>
<li class="chapter" data-level="3.2.6" data-path="factors-and-lists.html"><a href="factors-and-lists.html#frequency-tables"><i class="fa fa-check"></i><b>3.2.6</b> Frequency Tables<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="factors-and-lists.html"><a href="factors-and-lists.html#lists"><i class="fa fa-check"></i><b>3.3</b> Lists<span></span></a><ul>
<li class="chapter" data-level="3.3.1" data-path="factors-and-lists.html"><a href="factors-and-lists.html#nested-lists"><i class="fa fa-check"></i><b>3.3.1</b> Nested Lists<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="factors-and-lists.html"><a href="factors-and-lists.html#list---basic-features"><i class="fa fa-check"></i><b>3.4</b> List - Basic Features<span></span></a><ul>
<li class="chapter" data-level="3.4.1" data-path="factors-and-lists.html"><a href="factors-and-lists.html#length-2"><i class="fa fa-check"></i><b>3.4.1</b> Length<span></span></a></li>
<li class="chapter" data-level="3.4.2" data-path="factors-and-lists.html"><a href="factors-and-lists.html#coercion-2"><i class="fa fa-check"></i><b>3.4.2</b> Coercion<span></span></a></li>
<li class="chapter" data-level="3.4.3" data-path="factors-and-lists.html"><a href="factors-and-lists.html#testingclass-1"><i class="fa fa-check"></i><b>3.4.3</b> Testing/Class<span></span></a></li>
<li class="chapter" data-level="3.4.4" data-path="factors-and-lists.html"><a href="factors-and-lists.html#names-2"><i class="fa fa-check"></i><b>3.4.4</b> Names<span></span></a></li>
<li class="chapter" data-level="3.4.5" data-path="factors-and-lists.html"><a href="factors-and-lists.html#accessing-elements-1"><i class="fa fa-check"></i><b>3.4.5</b> Accessing Elements<span></span></a></li>
</ul></li>
<li><a href="factors-and-lists.html#summary-1">Summary<span></span></a></li>
<li><a href="factors-and-lists.html#additional-resources-2">Additional Resources<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="matrices-data-frames-and-more.html"><a href="matrices-data-frames-and-more.html"><i class="fa fa-check"></i><b>4</b> Matrices, Data Frames, and More<span></span></a><ul>
<li class="chapter" data-level="4.1" data-path="matrices-data-frames-and-more.html"><a href="matrices-data-frames-and-more.html#matrices"><i class="fa fa-check"></i><b>4.1</b> Matrices<span></span></a><ul>
<li class="chapter" data-level="4.1.1" data-path="matrices-data-frames-and-more.html"><a href="matrices-data-frames-and-more.html#vectorized-operations"><i class="fa fa-check"></i><b>4.1.1</b> Vectorized Operations<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="matrices-data-frames-and-more.html"><a href="matrices-data-frames-and-more.html#data-frames"><i class="fa fa-check"></i><b>4.2</b> Data Frames<span></span></a><ul>
<li class="chapter" data-level="4.2.1" data-path="matrices-data-frames-and-more.html"><a href="matrices-data-frames-and-more.html#column-names"><i class="fa fa-check"></i><b>4.2.1</b> Column Names<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="matrices-data-frames-and-more.html"><a href="matrices-data-frames-and-more.html#basic-features-of-matricesdata-frames"><i class="fa fa-check"></i><b>4.3</b> Basic Features of Matrices/Data-Frames<span></span></a><ul>
<li class="chapter" data-level="4.3.1" data-path="matrices-data-frames-and-more.html"><a href="matrices-data-frames-and-more.html#dimensions"><i class="fa fa-check"></i><b>4.3.1</b> Dimensions<span></span></a></li>
<li class="chapter" data-level="4.3.2" data-path="matrices-data-frames-and-more.html"><a href="matrices-data-frames-and-more.html#accesing-elements"><i class="fa fa-check"></i><b>4.3.2</b> Accesing Elements<span></span></a></li>
<li class="chapter" data-level="4.3.3" data-path="matrices-data-frames-and-more.html"><a href="matrices-data-frames-and-more.html#coercion-3"><i class="fa fa-check"></i><b>4.3.3</b> Coercion<span></span></a></li>
<li class="chapter" data-level="4.3.4" data-path="matrices-data-frames-and-more.html"><a href="matrices-data-frames-and-more.html#testingclass-2"><i class="fa fa-check"></i><b>4.3.4</b> Testing/Class<span></span></a></li>
<li class="chapter" data-level="4.3.5" data-path="matrices-data-frames-and-more.html"><a href="matrices-data-frames-and-more.html#names-3"><i class="fa fa-check"></i><b>4.3.5</b> Names<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="matrices-data-frames-and-more.html"><a href="matrices-data-frames-and-more.html#other-object-types-and-the-global-environment"><i class="fa fa-check"></i><b>4.4</b> Other Object Types and the Global Environment<span></span></a></li>
<li><a href="matrices-data-frames-and-more.html#summary-2">Summary<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="indexing.html"><a href="indexing.html"><i class="fa fa-check"></i><b>5</b> Indexing<span></span></a><ul>
<li class="chapter" data-level="5.1" data-path="indexing.html"><a href="indexing.html#VectorIndex"><i class="fa fa-check"></i><b>5.1</b> Atomic Vectors and Factors<span></span></a><ul>
<li><a href="indexing.html#example-positive-integers">Example: Positive Integers<span></span></a></li>
<li><a href="indexing.html#example-negative-integers">Example: Negative Integers<span></span></a></li>
<li><a href="indexing.html#example-logical-values">Example: Logical Values<span></span></a></li>
<li><a href="indexing.html#example-names">Example: Names<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="indexing.html"><a href="indexing.html#lists-1"><i class="fa fa-check"></i><b>5.2</b> Lists<span></span></a><ul>
<li class="chapter" data-level="5.2.1" data-path="indexing.html"><a href="indexing.html#double-brackets"><i class="fa fa-check"></i><b>5.2.1</b> Double Brackets<span></span></a></li>
<li class="chapter" data-level="5.2.2" data-path="indexing.html"><a href="indexing.html#dollar-sign"><i class="fa fa-check"></i><b>5.2.2</b> Dollar Sign<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="indexing.html"><a href="indexing.html#matrices-1"><i class="fa fa-check"></i><b>5.3</b> Matrices<span></span></a><ul>
<li class="chapter" data-level="5.3.1" data-path="indexing.html"><a href="indexing.html#two-vectors"><i class="fa fa-check"></i><b>5.3.1</b> Two Vectors<span></span></a></li>
<li class="chapter" data-level="5.3.2" data-path="indexing.html"><a href="indexing.html#single-vector"><i class="fa fa-check"></i><b>5.3.2</b> Single Vector<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="indexing.html"><a href="indexing.html#data-frames-1"><i class="fa fa-check"></i><b>5.4</b> Data frames<span></span></a><ul>
<li><a href="indexing.html#example-double-brackets">Example: Double brackets<span></span></a></li>
<li><a href="indexing.html#example-dollar-sign">Example: Dollar Sign<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="indexing.html"><a href="indexing.html#features-and-applications"><i class="fa fa-check"></i><b>5.5</b> Features and Applications<span></span></a><ul>
<li class="chapter" data-level="5.5.1" data-path="indexing.html"><a href="indexing.html#indexing-and-reassignment"><i class="fa fa-check"></i><b>5.5.1</b> Indexing and Reassignment<span></span></a></li>
<li class="chapter" data-level="5.5.2" data-path="indexing.html"><a href="indexing.html#orderinginteger-indexing"><i class="fa fa-check"></i><b>5.5.2</b> Ordering/Integer Indexing<span></span></a></li>
<li class="chapter" data-level="5.5.3" data-path="indexing.html"><a href="indexing.html#adding-elementsrowscolumns"><i class="fa fa-check"></i><b>5.5.3</b> Adding Elements/Rows/Columns<span></span></a></li>
<li class="chapter" data-level="5.5.4" data-path="indexing.html"><a href="indexing.html#delete-elementsrowscolumns"><i class="fa fa-check"></i><b>5.5.4</b> Delete Elements/Rows/Columns<span></span></a></li>
<li class="chapter" data-level="5.5.5" data-path="indexing.html"><a href="indexing.html#select-based-on-condition"><i class="fa fa-check"></i><b>5.5.5</b> Select Based on Condition<span></span></a></li>
<li class="chapter" data-level="5.5.6" data-path="indexing.html"><a href="indexing.html#convert-indexing-techniques"><i class="fa fa-check"></i><b>5.5.6</b> Convert Indexing Techniques<span></span></a></li>
</ul></li>
<li><a href="indexing.html#summary-3">Summary<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="working-with-data-sets.html"><a href="working-with-data-sets.html"><i class="fa fa-check"></i><b>6</b> Working with Data Sets<span></span></a><ul>
<li class="chapter" data-level="6.1" data-path="working-with-data-sets.html"><a href="working-with-data-sets.html#LoadData"><i class="fa fa-check"></i><b>6.1</b> Getting Data Sets in Our Working Environment<span></span></a><ul>
<li><a href="working-with-data-sets.html#built-in-data">Built-In Data<span></span></a></li>
<li><a href="working-with-data-sets.html#importing-from-your-computer">Importing From Your Computer<span></span></a></li>
<li><a href="working-with-data-sets.html#import-from-online">Import From Online<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="working-with-data-sets.html"><a href="working-with-data-sets.html#basic-data-manipulation"><i class="fa fa-check"></i><b>6.2</b> Basic Data Manipulation<span></span></a><ul>
<li><a href="working-with-data-sets.html#subset">Subset<span></span></a></li>
<li><a href="working-with-data-sets.html#adding-columns">Adding Columns<span></span></a></li>
<li><a href="working-with-data-sets.html#na-values">NA values<span></span></a></li>
<li><a href="working-with-data-sets.html#null">NULL<span></span></a></li>
<li><a href="working-with-data-sets.html#adding-rows">Adding Rows<span></span></a></li>
</ul></li>
<li><a href="working-with-data-sets.html#summary-4">Summary<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>7</b> Functions<span></span></a><ul>
<li class="chapter" data-level="7.1" data-path="functions.html"><a href="functions.html#build-your-own-function"><i class="fa fa-check"></i><b>7.1</b> Build Your Own Function<span></span></a></li>
<li class="chapter" data-level="7.2" data-path="functions.html"><a href="functions.html#lexical-scoping"><i class="fa fa-check"></i><b>7.2</b> Lexical Scoping<span></span></a></li>
<li class="chapter" data-level="7.3" data-path="functions.html"><a href="functions.html#built-in-functions"><i class="fa fa-check"></i><b>7.3</b> Built-In Functions<span></span></a></li>
<li class="chapter" data-level="7.4" data-path="functions.html"><a href="functions.html#vectorization"><i class="fa fa-check"></i><b>7.4</b> Vectorization<span></span></a></li>
<li class="chapter" data-level="7.5" data-path="functions.html"><a href="functions.html#help-files"><i class="fa fa-check"></i><b>7.5</b> Help Files<span></span></a></li>
<li class="chapter" data-level="7.6" data-path="functions.html"><a href="functions.html#dots"><i class="fa fa-check"></i><b>7.6</b> The … Argument<span></span></a></li>
<li class="chapter" data-level="7.7" data-path="functions.html"><a href="functions.html#generic-functions"><i class="fa fa-check"></i><b>7.7</b> Generic Functions<span></span></a></li>
<li><a href="functions.html#additional-resources-3">Additional Resources<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="if-statements.html"><a href="if-statements.html"><i class="fa fa-check"></i><b>8</b> If Statements<span></span></a><ul>
<li class="chapter" data-level="8.1" data-path="if-statements.html"><a href="if-statements.html#if"><i class="fa fa-check"></i><b>8.1</b> If<span></span></a></li>
<li class="chapter" data-level="8.2" data-path="if-statements.html"><a href="if-statements.html#if-else"><i class="fa fa-check"></i><b>8.2</b> If Else<span></span></a></li>
<li class="chapter" data-level="8.3" data-path="if-statements.html"><a href="if-statements.html#elseif"><i class="fa fa-check"></i><b>8.3</b> Else If<span></span></a></li>
<li class="chapter" data-level="8.4" data-path="if-statements.html"><a href="if-statements.html#nested-if-chains"><i class="fa fa-check"></i><b>8.4</b> Nested If Chains<span></span></a></li>
<li class="chapter" data-level="8.5" data-path="if-statements.html"><a href="if-statements.html#ifelse"><i class="fa fa-check"></i><b>8.5</b> Ifelse<span></span></a></li>
<li><a href="if-statements.html#additional-resources-4">Additional Resources<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="apply-family-of-functions.html"><a href="apply-family-of-functions.html"><i class="fa fa-check"></i><b>9</b> *apply Family of Functions<span></span></a><ul>
<li class="chapter" data-level="9.1" data-path="apply-family-of-functions.html"><a href="apply-family-of-functions.html#introduction-to-the-apply-family"><i class="fa fa-check"></i><b>9.1</b> Introduction to the *apply family<span></span></a></li>
<li class="chapter" data-level="9.2" data-path="apply-family-of-functions.html"><a href="apply-family-of-functions.html#apply"><i class="fa fa-check"></i><b>9.2</b> apply()<span></span></a><ul>
<li><a href="apply-family-of-functions.html#example-built-in-function">Example: Built In Function<span></span></a></li>
<li><a href="apply-family-of-functions.html#example-user-defined-function">Example: User Defined Function<span></span></a></li>
<li class="chapter" data-level="9.2.1" data-path="apply-family-of-functions.html"><a href="apply-family-of-functions.html#returned-objects"><i class="fa fa-check"></i><b>9.2.1</b> Returned Objects<span></span></a></li>
<li class="chapter" data-level="9.2.2" data-path="apply-family-of-functions.html"><a href="apply-family-of-functions.html#example-extra-arguments-array-output"><i class="fa fa-check"></i><b>9.2.2</b> Example: Extra Arguments, Array Output<span></span></a></li>
<li class="chapter" data-level="9.2.3" data-path="apply-family-of-functions.html"><a href="apply-family-of-functions.html#example-list-output"><i class="fa fa-check"></i><b>9.2.3</b> Example: List Output<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="apply-family-of-functions.html"><a href="apply-family-of-functions.html#lapply"><i class="fa fa-check"></i><b>9.3</b> lapply()<span></span></a></li>
<li class="chapter" data-level="9.4" data-path="apply-family-of-functions.html"><a href="apply-family-of-functions.html#sapply"><i class="fa fa-check"></i><b>9.4</b> sapply()<span></span></a></li>
<li class="chapter" data-level="9.5" data-path="apply-family-of-functions.html"><a href="apply-family-of-functions.html#tapply"><i class="fa fa-check"></i><b>9.5</b> tapply()<span></span></a></li>
<li class="chapter" data-level="9.6" data-path="apply-family-of-functions.html"><a href="apply-family-of-functions.html#mapply"><i class="fa fa-check"></i><b>9.6</b> mapply()<span></span></a></li>
<li class="chapter" data-level="9.7" data-path="apply-family-of-functions.html"><a href="apply-family-of-functions.html#replicate"><i class="fa fa-check"></i><b>9.7</b> replicate()<span></span></a></li>
<li class="chapter" data-level="9.8" data-path="apply-family-of-functions.html"><a href="apply-family-of-functions.html#how-to-pick-a-method"><i class="fa fa-check"></i><b>9.8</b> How to Pick a Method<span></span></a></li>
<li class="chapter" data-level="9.9" data-path="apply-family-of-functions.html"><a href="apply-family-of-functions.html#vectorizeifelse"><i class="fa fa-check"></i><b>9.9</b> Vectorizing If-Statments<span></span></a></li>
<li class="chapter" data-level="9.10" data-path="apply-family-of-functions.html"><a href="apply-family-of-functions.html#more-examples"><i class="fa fa-check"></i><b>9.10</b> More Examples<span></span></a><ul>
<li class="chapter" data-level="9.10.1" data-path="apply-family-of-functions.html"><a href="apply-family-of-functions.html#create-a-new-variable"><i class="fa fa-check"></i><b>9.10.1</b> Create a New Variable<span></span></a></li>
</ul></li>
<li><a href="apply-family-of-functions.html#additional-resources-5">Additional Resources<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i><b>10</b> Packages<span></span></a><ul>
<li class="chapter" data-level="10.1" data-path="packages.html"><a href="packages.html#namespace-collisions"><i class="fa fa-check"></i><b>10.1</b> Namespace Collisions<span></span></a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="text-data.html"><a href="text-data.html"><i class="fa fa-check"></i><b>11</b> Text Data<span></span></a><ul>
<li class="chapter" data-level="11.1" data-path="text-data.html"><a href="text-data.html#making-strings"><i class="fa fa-check"></i><b>11.1</b> Making Strings<span></span></a></li>
<li class="chapter" data-level="11.2" data-path="text-data.html"><a href="text-data.html#substring-operations"><i class="fa fa-check"></i><b>11.2</b> Substring Operations<span></span></a></li>
<li class="chapter" data-level="11.3" data-path="text-data.html"><a href="text-data.html#dividing-strings-into-vectors"><i class="fa fa-check"></i><b>11.3</b> Dividing Strings into Vectors<span></span></a></li>
<li class="chapter" data-level="11.4" data-path="text-data.html"><a href="text-data.html#converting-objects-into-strings"><i class="fa fa-check"></i><b>11.4</b> Converting Objects into Strings<span></span></a></li>
<li class="chapter" data-level="11.5" data-path="text-data.html"><a href="text-data.html#versatility-of-the-paste-function"><i class="fa fa-check"></i><b>11.5</b> Versatility of the paste() Function<span></span></a></li>
<li class="chapter" data-level="11.6" data-path="text-data.html"><a href="text-data.html#substitution"><i class="fa fa-check"></i><b>11.6</b> Substitution<span></span></a></li>
<li class="chapter" data-level="11.7" data-path="text-data.html"><a href="text-data.html#text-of-some-importance"><i class="fa fa-check"></i><b>11.7</b> Text of Some Importance<span></span></a></li>
<li class="chapter" data-level="11.8" data-path="text-data.html"><a href="text-data.html#search"><i class="fa fa-check"></i><b>11.8</b> Search<span></span></a></li>
<li class="chapter" data-level="11.9" data-path="text-data.html"><a href="text-data.html#vectorizing-text-functions"><i class="fa fa-check"></i><b>11.9</b> Vectorizing Text Functions<span></span></a></li>
<li class="chapter" data-level="11.10" data-path="text-data.html"><a href="text-data.html#regular-expressions"><i class="fa fa-check"></i><b>11.10</b> Regular Expressions<span></span></a></li>
<li class="chapter" data-level="11.11" data-path="text-data.html"><a href="text-data.html#word-count-tables"><i class="fa fa-check"></i><b>11.11</b> Word Count Tables<span></span></a></li>
<li class="chapter" data-level="11.12" data-path="text-data.html"><a href="text-data.html#wordcloud-package"><i class="fa fa-check"></i><b>11.12</b> Wordcloud Package<span></span></a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="base-r-plotting.html"><a href="base-r-plotting.html"><i class="fa fa-check"></i><b>12</b> Base R Plotting<span></span></a><ul>
<li class="chapter" data-level="12.1" data-path="base-r-plotting.html"><a href="base-r-plotting.html#load-a-big-data-set"><i class="fa fa-check"></i><b>12.1</b> Load A Big Data Set<span></span></a></li>
<li class="chapter" data-level="12.2" data-path="base-r-plotting.html"><a href="base-r-plotting.html#histograms"><i class="fa fa-check"></i><b>12.2</b> Histograms<span></span></a></li>
<li class="chapter" data-level="12.3" data-path="base-r-plotting.html"><a href="base-r-plotting.html#boxplot"><i class="fa fa-check"></i><b>12.3</b> Boxplot<span></span></a></li>
<li class="chapter" data-level="12.4" data-path="base-r-plotting.html"><a href="base-r-plotting.html#scatter-plot"><i class="fa fa-check"></i><b>12.4</b> Scatter Plot<span></span></a></li>
<li class="chapter" data-level="12.5" data-path="base-r-plotting.html"><a href="base-r-plotting.html#pie-charts"><i class="fa fa-check"></i><b>12.5</b> Pie Charts<span></span></a></li>
<li class="chapter" data-level="12.6" data-path="base-r-plotting.html"><a href="base-r-plotting.html#adding-straight-lines"><i class="fa fa-check"></i><b>12.6</b> Adding Straight Lines<span></span></a></li>
<li class="chapter" data-level="12.7" data-path="base-r-plotting.html"><a href="base-r-plotting.html#adding-lines-between-points"><i class="fa fa-check"></i><b>12.7</b> Adding Lines Between Points<span></span></a></li>
<li class="chapter" data-level="12.8" data-path="base-r-plotting.html"><a href="base-r-plotting.html#adding-individual-points"><i class="fa fa-check"></i><b>12.8</b> Adding Individual Points<span></span></a></li>
<li class="chapter" data-level="12.9" data-path="base-r-plotting.html"><a href="base-r-plotting.html#the-par-help-file"><i class="fa fa-check"></i><b>12.9</b> The par() Help File<span></span></a></li>
<li class="chapter" data-level="12.10" data-path="base-r-plotting.html"><a href="base-r-plotting.html#adding-legends"><i class="fa fa-check"></i><b>12.10</b> Adding Legends<span></span></a></li>
<li class="chapter" data-level="12.11" data-path="base-r-plotting.html"><a href="base-r-plotting.html#what-makes-a-good-plot"><i class="fa fa-check"></i><b>12.11</b> What makes a good plot?<span></span></a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="extending-base-r-graphics.html"><a href="extending-base-r-graphics.html"><i class="fa fa-check"></i><b>13</b> Extending Base R Graphics<span></span></a><ul>
<li class="chapter" data-level="13.1" data-path="extending-base-r-graphics.html"><a href="extending-base-r-graphics.html#the-maps-package"><i class="fa fa-check"></i><b>13.1</b> The “maps” Package<span></span></a></li>
<li class="chapter" data-level="13.2" data-path="extending-base-r-graphics.html"><a href="extending-base-r-graphics.html#some-additional-packages-to-consider"><i class="fa fa-check"></i><b>13.2</b> Some additional Packages to consider<span></span></a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="loops.html"><a href="loops.html"><i class="fa fa-check"></i><b>14</b> Loops<span></span></a><ul>
<li class="chapter" data-level="14.1" data-path="loops.html"><a href="loops.html#while-loop"><i class="fa fa-check"></i><b>14.1</b> While Loop<span></span></a></li>
<li class="chapter" data-level="14.2" data-path="loops.html"><a href="loops.html#for-loops"><i class="fa fa-check"></i><b>14.2</b> For Loops<span></span></a></li>
<li class="chapter" data-level="14.3" data-path="loops.html"><a href="loops.html#break"><i class="fa fa-check"></i><b>14.3</b> Break<span></span></a></li>
<li class="chapter" data-level="14.4" data-path="loops.html"><a href="loops.html#next"><i class="fa fa-check"></i><b>14.4</b> Next<span></span></a></li>
<li class="chapter" data-level="14.5" data-path="loops.html"><a href="loops.html#nested-loops"><i class="fa fa-check"></i><b>14.5</b> Nested Loops<span></span></a></li>
<li class="chapter" data-level="14.6" data-path="loops.html"><a href="loops.html#examples-1"><i class="fa fa-check"></i><b>14.6</b> Examples<span></span></a><ul>
<li class="chapter" data-level="14.6.1" data-path="loops.html"><a href="loops.html#example-1"><i class="fa fa-check"></i><b>14.6.1</b> Example 1<span></span></a></li>
<li class="chapter" data-level="14.6.2" data-path="loops.html"><a href="loops.html#example-2"><i class="fa fa-check"></i><b>14.6.2</b> Example 2<span></span></a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="loops.html"><a href="loops.html#additional-resources-6"><i class="fa fa-check"></i><b>14.7</b> Additional Resources<span></span></a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="simulation.html"><a href="simulation.html"><i class="fa fa-check"></i><b>15</b> Simulation<span></span></a><ul>
<li class="chapter" data-level="15.1" data-path="simulation.html"><a href="simulation.html#what-are-simulation-studies"><i class="fa fa-check"></i><b>15.1</b> What Are Simulation Studies<span></span></a></li>
<li class="chapter" data-level="15.2" data-path="simulation.html"><a href="simulation.html#review-random-variables-and-probability"><i class="fa fa-check"></i><b>15.2</b> Review Random Variables and Probability<span></span></a><ul>
<li class="chapter" data-level="15.2.1" data-path="simulation.html"><a href="simulation.html#probability"><i class="fa fa-check"></i><b>15.2.1</b> Probability<span></span></a></li>
<li class="chapter" data-level="15.2.2" data-path="simulation.html"><a href="simulation.html#fundamental-theorem-of-statistics"><i class="fa fa-check"></i><b>15.2.2</b> Fundamental Theorem of Statistics<span></span></a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="simulation.html"><a href="simulation.html#simulating-an-event"><i class="fa fa-check"></i><b>15.3</b> Simulating an Event<span></span></a><ul>
<li class="chapter" data-level="15.3.1" data-path="simulation.html"><a href="simulation.html#running-average-plot"><i class="fa fa-check"></i><b>15.3.1</b> Running Average Plot<span></span></a></li>
<li class="chapter" data-level="15.3.2" data-path="simulation.html"><a href="simulation.html#set-seed"><i class="fa fa-check"></i><b>15.3.2</b> Set Seed<span></span></a></li>
<li class="chapter" data-level="15.3.3" data-path="simulation.html"><a href="simulation.html#stopping-rules"><i class="fa fa-check"></i><b>15.3.3</b> Stopping Rules<span></span></a></li>
<li class="chapter" data-level="15.3.4" data-path="simulation.html"><a href="simulation.html#another-example"><i class="fa fa-check"></i><b>15.3.4</b> Another Example<span></span></a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="simulation.html"><a href="simulation.html#working-with-known-distributions"><i class="fa fa-check"></i><b>15.4</b> Working with Known Distributions<span></span></a><ul>
<li class="chapter" data-level="15.4.1" data-path="simulation.html"><a href="simulation.html#generating-random-variables"><i class="fa fa-check"></i><b>15.4.1</b> Generating Random Variables<span></span></a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="simulation.html"><a href="simulation.html#simulating-a-distribution"><i class="fa fa-check"></i><b>15.5</b> Simulating a Distribution<span></span></a></li>
<li class="chapter" data-level="15.6" data-path="simulation.html"><a href="simulation.html#simulating-a-statisticmean"><i class="fa fa-check"></i><b>15.6</b> Simulating a Statistic/Mean<span></span></a></li>
<li class="chapter" data-level="15.7" data-path="simulation.html"><a href="simulation.html#some-more-tools"><i class="fa fa-check"></i><b>15.7</b> Some More Tools<span></span></a><ul>
<li class="chapter" data-level="15.7.1" data-path="simulation.html"><a href="simulation.html#sample"><i class="fa fa-check"></i><b>15.7.1</b> sample()<span></span></a></li>
<li class="chapter" data-level="15.7.2" data-path="simulation.html"><a href="simulation.html#adding-curves-to-graphs"><i class="fa fa-check"></i><b>15.7.2</b> Adding curves to graphs<span></span></a></li>
</ul></li>
<li class="chapter" data-level="15.8" data-path="simulation.html"><a href="simulation.html#example-fundamental-theorem-of-statistics"><i class="fa fa-check"></i><b>15.8</b> Example: Fundamental Theorem of Statistics<span></span></a><ul>
<li class="chapter" data-level="15.8.1" data-path="simulation.html"><a href="simulation.html#more-rigorous-version-of-fts"><i class="fa fa-check"></i><b>15.8.1</b> More Rigorous version of FTS<span></span></a></li>
<li class="chapter" data-level="15.8.2" data-path="simulation.html"><a href="simulation.html#assumption-violations-of-fts"><i class="fa fa-check"></i><b>15.8.2</b> Assumption Violations of FTS<span></span></a></li>
<li class="chapter" data-level="15.8.3" data-path="simulation.html"><a href="simulation.html#the-data"><i class="fa fa-check"></i><b>15.8.3</b> The Data<span></span></a></li>
</ul></li>
<li class="chapter" data-level="15.9" data-path="simulation.html"><a href="simulation.html#simulation-stuides-for-statistical-methods"><i class="fa fa-check"></i><b>15.9</b> Simulation Stuides for Statistical Methods<span></span></a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="tidyverse.html"><a href="tidyverse.html"><i class="fa fa-check"></i><b>16</b> Tidyverse<span></span></a><ul>
<li class="chapter" data-level="16.1" data-path="tidyverse.html"><a href="tidyverse.html#piping-operator"><i class="fa fa-check"></i><b>16.1</b> Piping Operator<span></span></a></li>
<li class="chapter" data-level="16.2" data-path="tidyverse.html"><a href="tidyverse.html#tibbles-vs-data-frames"><i class="fa fa-check"></i><b>16.2</b> Tibbles vs Data Frames<span></span></a></li>
<li class="chapter" data-level="16.3" data-path="tidyverse.html"><a href="tidyverse.html#key-functions"><i class="fa fa-check"></i><b>16.3</b> Key Functions<span></span></a><ul>
<li class="chapter" data-level="16.3.1" data-path="tidyverse.html"><a href="tidyverse.html#general-properties"><i class="fa fa-check"></i><b>16.3.1</b> General properties<span></span></a></li>
<li class="chapter" data-level="16.3.2" data-path="tidyverse.html"><a href="tidyverse.html#select"><i class="fa fa-check"></i><b>16.3.2</b> select()<span></span></a></li>
<li class="chapter" data-level="16.3.3" data-path="tidyverse.html"><a href="tidyverse.html#filter"><i class="fa fa-check"></i><b>16.3.3</b> filter()<span></span></a></li>
<li class="chapter" data-level="16.3.4" data-path="tidyverse.html"><a href="tidyverse.html#arrange"><i class="fa fa-check"></i><b>16.3.4</b> arrange()<span></span></a></li>
<li class="chapter" data-level="16.3.5" data-path="tidyverse.html"><a href="tidyverse.html#rename"><i class="fa fa-check"></i><b>16.3.5</b> rename()<span></span></a></li>
<li class="chapter" data-level="16.3.6" data-path="tidyverse.html"><a href="tidyverse.html#mutate"><i class="fa fa-check"></i><b>16.3.6</b> mutate()<span></span></a></li>
<li class="chapter" data-level="16.3.7" data-path="tidyverse.html"><a href="tidyverse.html#group_by"><i class="fa fa-check"></i><b>16.3.7</b> group_by()<span></span></a></li>
<li class="chapter" data-level="16.3.8" data-path="tidyverse.html"><a href="tidyverse.html#summarizesummarise"><i class="fa fa-check"></i><b>16.3.8</b> summarize()/summarise()<span></span></a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="tidyverse.html"><a href="tidyverse.html#examples-2"><i class="fa fa-check"></i><b>16.4</b> Examples<span></span></a><ul>
<li class="chapter" data-level="16.4.1" data-path="tidyverse.html"><a href="tidyverse.html#example-1-1"><i class="fa fa-check"></i><b>16.4.1</b> Example 1<span></span></a></li>
<li class="chapter" data-level="16.4.2" data-path="tidyverse.html"><a href="tidyverse.html#example-2-1"><i class="fa fa-check"></i><b>16.4.2</b> Example 2<span></span></a></li>
<li class="chapter" data-level="16.4.3" data-path="tidyverse.html"><a href="tidyverse.html#example-3"><i class="fa fa-check"></i><b>16.4.3</b> Example 3<span></span></a></li>
</ul></li>
<li><a href="tidyverse.html#additional-resources-7">Additional Resources<span></span></a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>17</b> ggplot2<span></span></a><ul>
<li class="chapter" data-level="17.1" data-path="ggplot2.html"><a href="ggplot2.html#tidyverse-and-ggplot2"><i class="fa fa-check"></i><b>17.1</b> Tidyverse and ggplot2<span></span></a></li>
<li class="chapter" data-level="17.2" data-path="ggplot2.html"><a href="ggplot2.html#intro-to-ggplot2"><i class="fa fa-check"></i><b>17.2</b> Intro to ggplot2<span></span></a><ul>
<li><a href="ggplot2.html#what-is-the-grammar-of-graphics">What is the grammar of graphics?<span></span></a></li>
<li><a href="ggplot2.html#ggplot2-versus-other-r-graphics">ggplot2 versus other R Graphics<span></span></a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="ggplot2.html"><a href="ggplot2.html#getting-started-kep-components"><i class="fa fa-check"></i><b>17.3</b> Getting started: Kep Components<span></span></a></li>
<li class="chapter" data-level="17.4" data-path="ggplot2.html"><a href="ggplot2.html#adjust-aesthetic-attributes-by-variable"><i class="fa fa-check"></i><b>17.4</b> Adjust aesthetic attributes by variable<span></span></a></li>
<li class="chapter" data-level="17.5" data-path="ggplot2.html"><a href="ggplot2.html#adjust-aesthetic-attributes-for-the-entire-plot"><i class="fa fa-check"></i><b>17.5</b> Adjust aesthetic attributes for the entire plot<span></span></a></li>
<li class="chapter" data-level="17.6" data-path="ggplot2.html"><a href="ggplot2.html#faceting"><i class="fa fa-check"></i><b>17.6</b> Faceting<span></span></a></li>
<li class="chapter" data-level="17.7" data-path="ggplot2.html"><a href="ggplot2.html#some-example-plots"><i class="fa fa-check"></i><b>17.7</b> Some example plots<span></span></a></li>
<li class="chapter" data-level="17.8" data-path="ggplot2.html"><a href="ggplot2.html#where-can-i-learn-more"><i class="fa fa-check"></i><b>17.8</b> Where can I learn more?<span></span></a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="Regex.html"><a href="Regex.html"><i class="fa fa-check"></i><b>18</b> Regular Expressions<span></span></a><ul>
<li class="chapter" data-level="18.1" data-path="Regex.html"><a href="Regex.html#ranges-escaping"><i class="fa fa-check"></i><b>18.1</b> Ranges, Escaping<span></span></a></li>
<li class="chapter" data-level="18.2" data-path="Regex.html"><a href="Regex.html#metacharacters"><i class="fa fa-check"></i><b>18.2</b> Metacharacters<span></span></a></li>
<li class="chapter" data-level="18.3" data-path="Regex.html"><a href="Regex.html#quantifiers"><i class="fa fa-check"></i><b>18.3</b> Quantifiers<span></span></a></li>
<li class="chapter" data-level="18.4" data-path="Regex.html"><a href="Regex.html#anchoring"><i class="fa fa-check"></i><b>18.4</b> Anchoring<span></span></a></li>
<li class="chapter" data-level="18.5" data-path="Regex.html"><a href="Regex.html#splitting-on-a-regexp"><i class="fa fa-check"></i><b>18.5</b> Splitting on a Regexp<span></span></a></li>
<li class="chapter" data-level="18.6" data-path="Regex.html"><a href="Regex.html#stringr-package"><i class="fa fa-check"></i><b>18.6</b> Stringr Package<span></span></a></li>
<li class="chapter" data-level="18.7" data-path="Regex.html"><a href="Regex.html#wordcloud-package-1"><i class="fa fa-check"></i><b>18.7</b> Wordcloud Package<span></span></a></li>
<li class="chapter" data-level="18.8" data-path="Regex.html"><a href="Regex.html#replacements"><i class="fa fa-check"></i><b>18.8</b> Replacements<span></span></a></li>
<li><a href="Regex.html#additional-resources-8">Additional Resources<span></span></a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="debugging.html"><a href="debugging.html"><i class="fa fa-check"></i><b>19</b> Debugging<span></span></a><ul>
<li class="chapter" data-level="19.1" data-path="debugging.html"><a href="debugging.html#debugging-background-history-types-of-bugs-challenges-to-consider"><i class="fa fa-check"></i><b>19.1</b> Debugging Background (History, Types of Bugs, Challenges to Consider)<span></span></a><ul>
<li><a href="debugging.html#types-of-bugs">Types of bugs<span></span></a></li>
<li><a href="debugging.html#debugging-process-difficulties">Debugging Process Difficulties<span></span></a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="debugging.html"><a href="debugging.html#debugging-strategies-in-general"><i class="fa fa-check"></i><b>19.2</b> Debugging Strategies In General<span></span></a><ul>
<li class="chapter" data-level="19.2.1" data-path="debugging.html"><a href="debugging.html#example-of-the-binary-search-algorithm"><i class="fa fa-check"></i><b>19.2.1</b> Example of the Binary Search Algorithm<span></span></a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="debugging.html"><a href="debugging.html#using-debuggers"><i class="fa fa-check"></i><b>19.3</b> Using Debuggers<span></span></a><ul>
<li class="chapter" data-level="19.3.1" data-path="debugging.html"><a href="debugging.html#traceback"><i class="fa fa-check"></i><b>19.3.1</b> traceback()<span></span></a></li>
<li><a href="debugging.html#example-with-traceback">Example with traceback()<span></span></a></li>
<li><a href="debugging.html#unfamiliar-function-with-traceback">Unfamiliar function with traceback()<span></span></a></li>
<li class="chapter" data-level="19.3.2" data-path="debugging.html"><a href="debugging.html#browswer"><i class="fa fa-check"></i><b>19.3.2</b> browswer()<span></span></a></li>
<li class="chapter" data-level="19.3.3" data-path="debugging.html"><a href="debugging.html#debug"><i class="fa fa-check"></i><b>19.3.3</b> debug()<span></span></a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="debugging.html"><a href="debugging.html#more-options-to-consider"><i class="fa fa-check"></i><b>19.4</b> More options to consider<span></span></a></li>
<li class="chapter" data-level="19.5" data-path="debugging.html"><a href="debugging.html#important-takeaways"><i class="fa fa-check"></i><b>19.5</b> Important Takeaways<span></span></a><ul>
<li><a href="debugging.html#tips-for-writing-good-code">Tips for Writing good code<span></span></a></li>
<li><a href="debugging.html#steps-to-reduce-the-number-of-bugs">Steps to Reduce the Number of Bugs<span></span></a></li>
<li><a href="debugging.html#after-you-located-the-error">After You Located the Error<span></span></a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="debugging.html"><a href="debugging.html#resources"><i class="fa fa-check"></i><b>19.6</b> Resources<span></span></a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">STAT 107 Outline of Class Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simulation" class="section level1 hasAnchor">
<h1><span class="header-section-number">Chapter 15</span> Simulation<a href="simulation.html#simulation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="what-are-simulation-studies" class="section level2 hasAnchor">
<h2><span class="header-section-number">15.1</span> What Are Simulation Studies<a href="simulation.html#what-are-simulation-studies" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Simulation studies are used in statistics to verify theoretical results, and to do “what-if” experiments. The are commonly used in a variety of applications and fields. Often times we have a particular theory or an idea about how things work. In order to verify that our theory is correct we can simulate a data set with known properties, and then check if the data set matches our theory. In short, a simulation study is a computer experiment that involves creating data that is used to estimate probabilities, densities, statistics, and compare performance of methods.</p>
<p>Simulations are very important, and can range greatly in complexity. We will focus on simple techniques in this section. For a more complete discussion on simulation studies in statistics, and best practices see this freely available article online at <a href="https://onlinelibrary.wiley.com/doi/10.1002/sim.8086">https://onlinelibrary.wiley.com/doi/10.1002/sim.8086</a>.</p>
</div>
<div id="review-random-variables-and-probability" class="section level2 hasAnchor">
<h2><span class="header-section-number">15.2</span> Review Random Variables and Probability<a href="simulation.html#review-random-variables-and-probability" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before discussing how to simulate data with specific properties we review the concept of a random variable. This discussion is adapted primarily from Chapter 3 and 4 of <span class="citation">Diez, Cetinkaya-Rundel, and Barr (<a href="#ref-OpenIntro" role="doc-biblioref">2020</a>)</span>. A <strong>random variable</strong> is a random process or variable with a numeric outcome. Each outcome is associated with a particular probability. The <strong>distribution</strong> of a random variable is a map for the possible outcomes and the respective probabilities. Distributions can be in the form of tables, histograms, and formulas. Random variables in general have a typical value which is called the <strong>expected value</strong>, this is the most common value we would expect the random variable to be. However, in practice random variables also have variability, so we do not expect to obtain the expected value for every random variable.</p>
<p>Some examples of random variables include: what side a fair sided coin lands on, what side a dice lands on, and how tall an adult bison is. We can ask about specific probabilities associated with this random variables. Some probabilities are easier to find than others:</p>
<ul>
<li><p>Suppose we flip a fair sided coin. What is the probability we land on a head?</p></li>
<li><p>Suppose we role a fair d6. What is the probability we land on a 5 or a 6?</p></li>
<li><p>Suppose we measure the height of an adult bison (in feet). What is the probability the height is between 4ft and 6ft?</p></li>
</ul>
<div id="probability" class="section level3 hasAnchor">
<h3><span class="header-section-number">15.2.1</span> Probability<a href="simulation.html#probability" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We like to analyze random variables and study the probability of a particular set of outcomes, an <strong>event</strong>. There are two types of probabilities we can think of.</p>
<ul>
<li><p><strong>Empirical Probability</strong>: a probability based on, concerned with, or verifiable by observation or experience</p>
<ul>
<li><p>Based on observed/sample data</p></li>
<li><p>Let <span class="math inline">\(X=\)</span> the number of times we observe an event, and <span class="math inline">\(n=\)</span> the number of trials</p></li>
<li><p>The empirical probability of an event is <span class="math inline">\(\hat{p} = \frac{X}{n}\)</span></p></li>
<li><p>Also known as the sample estimate</p></li>
</ul></li>
<li><p><strong>Theoretical Probability</strong>: a probability based on a system of ideas intended to explain something, especially one based on general principles independent of the thing to be explained.</p>
<ul>
<li><p>Based on a statistical, physical, or biological principals.</p></li>
<li><p>It is a probability we would expect “in theory”.</p></li>
<li><p>Denoted by <span class="math inline">\(p\)</span></p></li>
<li><p>Sometimes called the hypothesized probability</p></li>
</ul></li>
</ul>
<p>In real life we do not know the true probability, instead we have a probability we expect <em>in theory</em>, and we estimate a probability using <em>empirical/sample</em> data. Then we check if our estimate and theory are similar. Both types of probabilities follow the same rules and axioms we learn in introductory statistics courses.</p>
</div>
<div id="fundamental-theorem-of-statistics" class="section level3 hasAnchor">
<h3><span class="header-section-number">15.2.2</span> Fundamental Theorem of Statistics<a href="simulation.html#fundamental-theorem-of-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<center>
<img src="images/super.png" hieght="200%" />
</center>
<p>The fundamental theorem of statistics (FTS) connects empirical probabilities and theoretical probabilities together. This theorem goes by many names: <em>Central Limit Theorem</em> , <em>Law of Large Numbers</em>, etc. It is the “Superman” of statistical theories, and is HUGELY important in statistics. For many statistical inference methods (confidence intervals, p-values, hypothesis tests), we have a theory (theoretical probability), we get a sample and calculate an estimate (empirical probability), and then we check if the two types are similar to each other and make a conclusion. The FTS says that our empirical probability eventually will converge to the true probability as the sample size gets larger. So if our empirical probability and theoretical probability are close together, then are theory is likely to be correct. In contrast, if they are not close together, are theory is likely to be wrong.</p>
<div class="webnots-information webnots-notification-box">
<p>By the <strong><em>Fundamental Theorem of Statistics</em></strong>, we expect that our empirical probabilities converge to the theoretical/true probabilities as the sample size increases.</p>
<p><span class="math display">\[\hat{p} \rightarrow p\]</span></p>
</div>
<p>Many different versions of this theorem, and different names for the theorem. We have discussed this theorem in terms of probabilities, but we can also talk about it in terms of statistics, like the arithmetic mean. The principal is the same though, the empirical estimate will eventually converge to the true value as the sample size increases. This means bigger samples are more likely to converge to the truth, but how big should it be?</p>
</div>
</div>
<div id="simulating-an-event" class="section level2 hasAnchor">
<h2><span class="header-section-number">15.3</span> Simulating an Event<a href="simulation.html#simulating-an-event" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Suppose we have a fair sided coin and want to know the probability of flipping a heads. Our knowledge about coins tells us that the probability should be 0.5. This is the probability we expect <strong>in theory</strong> based on outside knowledge. However, we can also simulate flipping a coin, and estimating the probability of getting a head. Suppose we flip a coin 10 times and count how many heads we observe: H, H, T, T, T, T, H, T, T, T</p>
<p>We can create a data frame which shows are estimated probability based on the number of simulations we have.</p>
<div class="sourceCode" id="cb809"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb809-1"><a href="simulation.html#cb809-1"></a>NumHeads &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb809-2"><a href="simulation.html#cb809-2"></a>CumHeads &lt;-<span class="st"> </span><span class="kw">cumsum</span>(NumHeads)</span>
<span id="cb809-3"><a href="simulation.html#cb809-3"></a>EstHeads &lt;-<span class="st"> </span>CumHeads<span class="op">/</span><span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(NumHeads)</span>
<span id="cb809-4"><a href="simulation.html#cb809-4"></a></span>
<span id="cb809-5"><a href="simulation.html#cb809-5"></a>results &lt;-<span class="st"> </span><span class="kw">data.frame</span>(NumHeads, CumHeads, EstHeads)</span>
<span id="cb809-6"><a href="simulation.html#cb809-6"></a>results</span></code></pre></div>
<pre><code>##    NumHeads CumHeads  EstHeads
## 1         1        1 1.0000000
## 2         1        2 1.0000000
## 3         0        2 0.6666667
## 4         0        2 0.5000000
## 5         0        2 0.4000000
## 6         0        2 0.3333333
## 7         1        3 0.4285714
## 8         0        3 0.3750000
## 9         0        3 0.3333333
## 10        0        3 0.3000000</code></pre>
<p>Each row <span class="math inline">\(i\)</span> of the data frame represents simulation <span class="math inline">\(i\)</span>. The first column denotes when a head was observed, using a 1 for head and 0 for tails. The second column has the number of heads by simulation <span class="math inline">\(i\)</span>, this is known as the <em>cumulative number of heads</em>. The third column has the estimated/empirical probability of observing a heads using all the information up to simulation <span class="math inline">\(i\)</span>, which we can denote as <span class="math inline">\(\hat{p}_i\)</span>. Our final estimate for probability of observing a heads using this simulation study is <span class="math inline">\(\hat{p}_{10} = 0.3\)</span>. Is this a good simulation study?</p>
<div id="running-average-plot" class="section level3 hasAnchor">
<h3><span class="header-section-number">15.3.1</span> Running Average Plot<a href="simulation.html#running-average-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If we only flip the coin a few times, then the estimated probability that may not be accurate due to random fluctuation. However, the more coin flips we consider the more likely the estimated probability approaches the truth (which we known due to FTS). A fair question to ask with simulations is: “how many simulations do we need?”. There are rigorous rules that we can use to determine how many simulations we need until our estimate converges to the truth; however, we will focus on summary tables and visualization tools for now. We know we have enough simulations when our estimate seems to “stabilize”. We can track the statistics or the estimated probability as we consider more simulations. We can visualize this using a <strong>running average plot</strong>, also known as a <strong>cumulative proportion plot</strong>. In a running average plot we have the number of trials on the x-axis, and the estimated probability using all data up to trial <span class="math inline">\(i\)</span> on the y-axis. For example, consider the first five coin flips above: 1, 1, 0, 0, 0. Then the estimated probability of successes using “n” number of trials is the following.</p>
<ul>
<li>When the number of trials is <span class="math inline">\(n = 1\)</span>, the estimated probability of a head is <span class="math inline">\(\hat{p}_1 = (1)/1 = 1\)</span></li>
<li>When the number of trials is <span class="math inline">\(n = 2\)</span>, the estimated probability of a head is <span class="math inline">\(\hat{p}_2 = (1+1)/2 = 1\)</span></li>
<li>When the number of trials is <span class="math inline">\(n = 3\)</span>, the estimated probability of a head is <span class="math inline">\(\hat{p}_3 = (1+1+0)/3 = 2/3\)</span></li>
<li>When the number of trials is <span class="math inline">\(n = 4\)</span>, the estimated probability of a head is <span class="math inline">\(\hat{p}_4 = (1+1+0+0)/4 = 2/4\)</span></li>
<li>When the number of trials is <span class="math inline">\(n = 5\)</span>, the estimated probability of a head is<span class="math inline">\(\hat{p}_5 = (1+1+0+0+0)/5 = 2/5\)</span></li>
</ul>
<div class="sourceCode" id="cb811"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb811-1"><a href="simulation.html#cb811-1"></a><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(NumHeads), results<span class="op">$</span>EstHeads, <span class="dt">main =</span> <span class="st">&quot;Running Average Plot&quot;</span>,</span>
<span id="cb811-2"><a href="simulation.html#cb811-2"></a>    <span class="dt">xlab =</span> <span class="st">&quot;Simulation&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Estimated Probability&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb811-3"><a href="simulation.html#cb811-3"></a>    <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-277-1.png" width="672" /></p>
<p>Clearly, 10 coin flips is not enough. The plot is a bit erratic, and our final estimate is 0.3. We know we have not done enough simulations because we know the probability of getting a head is 0.5.</p>
</div>
<div id="set-seed" class="section level3 hasAnchor">
<h3><span class="header-section-number">15.3.2</span> Set Seed<a href="simulation.html#set-seed" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Another problem is the simulation itself. If you repeated this simulation you would get a very different answer. Often times when running a simulation we will want to use the same numbers over and over again. The function <code>sample()</code> generates values randomly though, which means each time we call this function we will get new and different values. In order to make sure our values are consistent each time we run R, or across computers we can set the seed. The seed determines the way the computer generates our random numbers. Normally the seed is random, so each time <code>sample()</code> is called we get a new random sequence. Using the <code>set.seed()</code> function will make sure that the sequence stays the same. Notice with different seeds we get different results.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-278-1.png" width="672" /></p>
</div>
<div id="stopping-rules" class="section level3 hasAnchor">
<h3><span class="header-section-number">15.3.3</span> Stopping Rules<a href="simulation.html#stopping-rules" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>It can be difficult to know when to stop the simulation. In general we need enough simulations so that way the estimate becomes <em>stable</em>. That is, until the plot stops behaving erratically regardless of the seed. <a href="https://rpgarcia.shinyapps.io/Coin1/">You can try this simulation on your own, and see when how many simulations you need for the estimate to become stable and try different seeds</a>.</p>
<p>Some simulations studies implement an <strong>stopping rule</strong>. A common stopping rule is to stop the simulation when <span class="math inline">\(|p_i - p_{i-1}| &lt; c\)</span>, where <span class="math inline">\(c\)</span> is some small number like 0.001. When using a stopping rule like this it is a good idea to initialize your simulations with a few trials to prevent stopping really early.</p>
<div class="sourceCode" id="cb812"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb812-1"><a href="simulation.html#cb812-1"></a><span class="co"># Initialize results with 10 simulations</span></span>
<span id="cb812-2"><a href="simulation.html#cb812-2"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb812-3"><a href="simulation.html#cb812-3"></a>NumHeads &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>), <span class="dv">10</span>, <span class="dt">replace =</span> T)</span>
<span id="cb812-4"><a href="simulation.html#cb812-4"></a>CumHeads &lt;-<span class="st"> </span><span class="kw">cumsum</span>(NumHeads)</span>
<span id="cb812-5"><a href="simulation.html#cb812-5"></a>EstHeads &lt;-<span class="st"> </span>CumHeads<span class="op">/</span><span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(NumHeads)</span>
<span id="cb812-6"><a href="simulation.html#cb812-6"></a>results &lt;-<span class="st"> </span><span class="kw">data.frame</span>(NumHeads, CumHeads, EstHeads)</span>
<span id="cb812-7"><a href="simulation.html#cb812-7"></a>i &lt;-<span class="st"> </span><span class="kw">nrow</span>(results)</span>
<span id="cb812-8"><a href="simulation.html#cb812-8"></a></span>
<span id="cb812-9"><a href="simulation.html#cb812-9"></a><span class="co"># Make a while loop that stops once estimate stablizes</span></span>
<span id="cb812-10"><a href="simulation.html#cb812-10"></a><span class="cf">while</span> (<span class="kw">abs</span>(results<span class="op">$</span>EstHeads[i] <span class="op">-</span><span class="st"> </span>results<span class="op">$</span>EstHeads[i <span class="op">-</span><span class="st"> </span><span class="dv">1</span>]) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.001</span>) {</span>
<span id="cb812-11"><a href="simulation.html#cb812-11"></a>    new_sim &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>), <span class="dv">1</span>, <span class="dt">replace =</span> T)</span>
<span id="cb812-12"><a href="simulation.html#cb812-12"></a>    new_cum_sum &lt;-<span class="st"> </span><span class="kw">sum</span>(results<span class="op">$</span>NumHeads, new_sim)</span>
<span id="cb812-13"><a href="simulation.html#cb812-13"></a>    new_est_prob &lt;-<span class="st"> </span>new_cum_sum<span class="op">/</span>i</span>
<span id="cb812-14"><a href="simulation.html#cb812-14"></a>    new_row &lt;-<span class="st"> </span><span class="kw">c</span>(new_sim, new_cum_sum, new_est_prob)</span>
<span id="cb812-15"><a href="simulation.html#cb812-15"></a></span>
<span id="cb812-16"><a href="simulation.html#cb812-16"></a>    results &lt;-<span class="st"> </span><span class="kw">rbind</span>(results, new_row)</span>
<span id="cb812-17"><a href="simulation.html#cb812-17"></a></span>
<span id="cb812-18"><a href="simulation.html#cb812-18"></a>    i &lt;-<span class="st"> </span>i <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb812-19"><a href="simulation.html#cb812-19"></a></span>
<span id="cb812-20"><a href="simulation.html#cb812-20"></a>    <span class="co"># Safety precaution to prevent loop running forever</span></span>
<span id="cb812-21"><a href="simulation.html#cb812-21"></a>    <span class="cf">if</span> (i <span class="op">&gt;</span><span class="st"> </span><span class="dv">10000</span>) {</span>
<span id="cb812-22"><a href="simulation.html#cb812-22"></a>        <span class="cf">break</span></span>
<span id="cb812-23"><a href="simulation.html#cb812-23"></a>    }</span>
<span id="cb812-24"><a href="simulation.html#cb812-24"></a>}</span>
<span id="cb812-25"><a href="simulation.html#cb812-25"></a></span>
<span id="cb812-26"><a href="simulation.html#cb812-26"></a><span class="kw">tail</span>(results)</span></code></pre></div>
<pre><code>##     NumHeads CumHeads  EstHeads
## 484        1      248 0.5134576
## 485        1      249 0.5144628
## 486        0      249 0.5134021
## 487        0      249 0.5123457
## 488        1      250 0.5133470
## 489        1      251 0.5143443</code></pre>
<p>It looks like it took 489 simulations to stabilize.</p>
<div class="sourceCode" id="cb814"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb814-1"><a href="simulation.html#cb814-1"></a><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(results), results<span class="op">$</span>EstHeads, <span class="dt">main =</span> <span class="st">&quot;Running Average Plot&quot;</span>,</span>
<span id="cb814-2"><a href="simulation.html#cb814-2"></a>    <span class="dt">xlab =</span> <span class="st">&quot;Simulation&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Estimated Probability&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb814-3"><a href="simulation.html#cb814-3"></a>    <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-280-1.png" width="672" /></p>
</div>
<div id="another-example" class="section level3 hasAnchor">
<h3><span class="header-section-number">15.3.4</span> Another Example<a href="simulation.html#another-example" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can also look at more complicated examples. For example, consider flipping 10 coins for each simulation and we want to know the probability getting three heads or less. This is a harder question, so we might consider creating a function to generate the results more succinctly. The function below returns a 1 if there are less than <code>less_than_value</code> heads out of ten coin flips.</p>
<div class="sourceCode" id="cb815"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb815-1"><a href="simulation.html#cb815-1"></a>heads_to_check &lt;-<span class="st"> </span><span class="cf">function</span>(less_than_value) {</span>
<span id="cb815-2"><a href="simulation.html#cb815-2"></a>    flip_results &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;Heads&quot;</span>, <span class="st">&quot;Tails&quot;</span>), <span class="dv">10</span>, <span class="dt">replace =</span> T)</span>
<span id="cb815-3"><a href="simulation.html#cb815-3"></a>    index_heads &lt;-<span class="st"> </span><span class="kw">which</span>(flip_results <span class="op">==</span><span class="st"> &quot;Heads&quot;</span>)</span>
<span id="cb815-4"><a href="simulation.html#cb815-4"></a>    num_heads &lt;-<span class="st"> </span><span class="kw">length</span>(index_heads)</span>
<span id="cb815-5"><a href="simulation.html#cb815-5"></a></span>
<span id="cb815-6"><a href="simulation.html#cb815-6"></a>    <span class="cf">if</span> (num_heads <span class="op">&lt;=</span><span class="st"> </span>less_than_value) {</span>
<span id="cb815-7"><a href="simulation.html#cb815-7"></a>        heads_less_than_value &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb815-8"><a href="simulation.html#cb815-8"></a>    } <span class="cf">else</span> {</span>
<span id="cb815-9"><a href="simulation.html#cb815-9"></a>        heads_less_than_value &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb815-10"><a href="simulation.html#cb815-10"></a>    }</span>
<span id="cb815-11"><a href="simulation.html#cb815-11"></a></span>
<span id="cb815-12"><a href="simulation.html#cb815-12"></a>    <span class="kw">return</span>(heads_less_than_value)</span>
<span id="cb815-13"><a href="simulation.html#cb815-13"></a>}</span></code></pre></div>
<p>Now each time we call this function it generates the random data for us. The following code generates three simulations.</p>
<div class="sourceCode" id="cb816"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb816-1"><a href="simulation.html#cb816-1"></a><span class="kw">heads_to_check</span>(<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb818"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb818-1"><a href="simulation.html#cb818-1"></a><span class="kw">heads_to_check</span>(<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb820"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb820-1"><a href="simulation.html#cb820-1"></a><span class="kw">heads_to_check</span>(<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>This is useful, but it is impractical to call this function hundreds of times. Instead, we can use a loop to repeatedly call the function until the probability of observing less than three heads out of ten stabilizes. If we also have a general idea of how many simulations we want already, we can use the <code>replicate()</code> function.</p>
<div class="sourceCode" id="cb822"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb822-1"><a href="simulation.html#cb822-1"></a><span class="co"># Calling this function 1000 times is easier with</span></span>
<span id="cb822-2"><a href="simulation.html#cb822-2"></a><span class="co"># replicate()</span></span>
<span id="cb822-3"><a href="simulation.html#cb822-3"></a><span class="kw">set.seed</span>(<span class="dv">26</span>)</span>
<span id="cb822-4"><a href="simulation.html#cb822-4"></a>results &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="kw">heads_to_check</span>(<span class="dv">3</span>))</span>
<span id="cb822-5"><a href="simulation.html#cb822-5"></a></span>
<span id="cb822-6"><a href="simulation.html#cb822-6"></a><span class="co"># Store Data</span></span>
<span id="cb822-7"><a href="simulation.html#cb822-7"></a>results &lt;-<span class="st"> </span><span class="kw">data.frame</span>(results, <span class="dt">cum_sum =</span> <span class="kw">cumsum</span>(results))</span>
<span id="cb822-8"><a href="simulation.html#cb822-8"></a>results<span class="op">$</span>est_prob &lt;-<span class="st"> </span>results<span class="op">$</span>cum_sum<span class="op">/</span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(results)</span>
<span id="cb822-9"><a href="simulation.html#cb822-9"></a></span>
<span id="cb822-10"><a href="simulation.html#cb822-10"></a><span class="kw">head</span>(results)</span></code></pre></div>
<pre><code>##   results cum_sum  est_prob
## 1       0       0 0.0000000
## 2       1       1 0.5000000
## 3       0       1 0.3333333
## 4       0       1 0.2500000
## 5       0       1 0.2000000
## 6       0       1 0.1666667</code></pre>
<div class="sourceCode" id="cb824"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb824-1"><a href="simulation.html#cb824-1"></a><span class="co"># Make running average plot</span></span>
<span id="cb824-2"><a href="simulation.html#cb824-2"></a><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(results), results<span class="op">$</span>est_prob, <span class="dt">ylab =</span> <span class="st">&quot;Estimated Prob&quot;</span>,</span>
<span id="cb824-3"><a href="simulation.html#cb824-3"></a>    <span class="dt">xlab =</span> <span class="st">&quot;Simulation&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Running average plot: 3 or less heads, from 10 flips&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-283-1.png" width="672" /></p>
<p><a href="https://rpgarcia.shinyapps.io/coin10/">To play with this simulation on your own click here.</a></p>
</div>
</div>
<div id="working-with-known-distributions" class="section level2 hasAnchor">
<h2><span class="header-section-number">15.4</span> Working with Known Distributions<a href="simulation.html#working-with-known-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We can do simulation studies on more than just a single probability. We can also do simulation studies to learn about the distribution of a random variable. Random variables generate observations according to some sort of pattern. These patterns are referred to as distributions, and can be analyzed visually, and analytically (i.e. through formulas).</p>
<p>Using a formula as a representation for a density is very versatile and useful. For these functions we have <strong>parameters</strong> which are values that let us further customize the function representation of a density to the specific random variable that we have. Let <span class="math inline">\(X\)</span> be a random variable, and <span class="math inline">\(x\)</span> be some observed value.</p>
<p>If <span class="math inline">\(X\)</span> is a random variable that can only take on values that are discrete (usually integers) then we say the probability of observing some a particular value, say <span class="math inline">\(x\)</span>, is denoted <span class="math inline">\(p(x)\)</span>. There are extremely well known discrete densities that random variables tend to follow and that are available in R. A few of them are listed below.</p>
<ul>
<li><strong>Binomial</strong>:</li>
</ul>
<p><span class="math display">\[p(x) = \binom{n}{x} p^x (1-p)^{n-x} \hspace{1cm} x = 0, ..., n\]</span></p>
<ul>
<li><p><strong>Poison</strong>:
<span class="math display">\[p(x) = λ^x exp(-λ)/x! \hspace{1cm} x = 0, ..., n\]</span></p></li>
<li><p><strong>Negative Binomial:</strong></p></li>
</ul>
<p><span class="math display">\[Γ(x+n)/(Γ(n) x!) p^n (1-p)^x   \hspace{1cm} x = 0, ..., \]</span></p>
<p>If <span class="math inline">\(X\)</span> is a random variable that can be any value within a range of numbers then we denote the density function of this random variable by <span class="math inline">\(f(x)\)</span>, this is a continuous random variable. As with discrete random variables, there are extremely well known continuous densities that random variables tend to follow and that are available in R. A few of them are listed below.</p>
<ul>
<li><strong>Uniform:</strong></li>
</ul>
<p><span class="math display">\[f(x) = 1/(max-min)\]</span></p>
<ul>
<li><strong>Log-Normal:</strong></li>
</ul>
<p><span class="math display">\[f(x) = 1/(√(2 π) σ x) e^{-((log{(x)} - μ)^2 / (2 σ^2))} \hspace{1cm} 0 &lt;x &lt; \infty\]</span></p>
<ul>
<li><strong>Exponential:</strong></li>
</ul>
<p><span class="math display">\[f(x) = λ {e}^{- λ x} \hspace{1cm} 0 &lt;x &lt; \infty\]</span></p>
<ul>
<li><p><strong>Normal</strong>:
<span class="math display">\[f(x) = 1/(√(2 π) σ) e^{-((x - μ)^2/(2 σ^2))} \hspace{1cm} -\infty &lt;x &lt; \infty\]</span></p></li>
<li><p><strong>t-Distribution</strong></p></li>
</ul>
<p><span class="math display">\[f(x) = Γ((n+1)/2) / (√(n π) Γ(n/2)) (1 + x^2/n)^-((n+1)/2)\hspace{1cm} -\infty &lt;x &lt; \infty\]</span></p>
<p>To see a complete list of well known distribution functions (or densities) that R already has see the help file <code>?Distributions</code>.</p>
<div id="generating-random-variables" class="section level3 hasAnchor">
<h3><span class="header-section-number">15.4.1</span> Generating Random Variables<a href="simulation.html#generating-random-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Each distribution available in base R is listed in <code>?Distributions</code>. Each of the distributions has a link to their corresponding help file which lists four main functions: <code>dxxx()</code>, <code>pxxx()</code>, <code>qxxx()</code> and <code>rxxx()</code>. These are the density function, cumulative distribution function, quantile function, and a random number generator for the particular random variable of interest. The letters <code>xxx</code> are replaced by an code for the particular random variable. The density function (<code>dxxx()</code>) generates the relative probability of observing a particular value. The cumulative distribution function (<code>pxxx()</code>) generates the probability of observing a particular value, and anything smaller than this value. The quantile function (<code>qxxx()</code>) generates what value corresponds to a given percentile. Lastly, the random number generator (<code>rxxx()</code>) will generate a random variable according to the given distribuiton/density. We will focus only on <code>dxxx()</code> and <code>rxxx()</code>.</p>
<p>For example, go to <code>?Distributions</code> and click on <code>dnorm</code> which corresponds to the normal distribution (in the bottom third of the list). Here you will see the functions <code>dnorm()</code>, <code>pnorm()</code>, <code>qnorm()</code>, and <code>rnorm()</code>. To generate a normal random variable with mean 0 and standard deviation 1 we can use the following command.</p>
<div class="sourceCode" id="cb825"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb825-1"><a href="simulation.html#cb825-1"></a><span class="co"># Generate a single normal random variable with mean 0 and</span></span>
<span id="cb825-2"><a href="simulation.html#cb825-2"></a><span class="co"># standard deviation 1</span></span>
<span id="cb825-3"><a href="simulation.html#cb825-3"></a><span class="kw">rnorm</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] -0.1545059</code></pre>
<div class="sourceCode" id="cb827"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb827-1"><a href="simulation.html#cb827-1"></a><span class="co"># Generate 20 normal random variables with mean 0 and</span></span>
<span id="cb827-2"><a href="simulation.html#cb827-2"></a><span class="co"># standard deviation 1</span></span>
<span id="cb827-3"><a href="simulation.html#cb827-3"></a><span class="kw">rnorm</span>(<span class="dv">20</span>)</span></code></pre></div>
<pre><code>##  [1] -1.73183694 -1.17100630 -0.14981662 -0.10343645  0.63199579  0.48543427
##  [7]  0.04936201  0.92111550 -0.25092886 -0.86457930 -1.52886442 -0.02578830
## [13] -0.87182251 -1.56344137 -2.64338842 -0.10758754  0.28252965 -0.46907419
## [19] -0.36083998  1.29157163</code></pre>
<p>However, as we saw in the previous section, these common distribution functions have parameters which let us further customize the behavior of the random variable. We can change the parameters of any of the distributions in R using the function arguments.</p>
<div class="sourceCode" id="cb829"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb829-1"><a href="simulation.html#cb829-1"></a><span class="co"># Normal random variable with mean 10, and standard</span></span>
<span id="cb829-2"><a href="simulation.html#cb829-2"></a><span class="co"># deviation 0.5</span></span>
<span id="cb829-3"><a href="simulation.html#cb829-3"></a><span class="kw">rnorm</span>(<span class="dv">1</span>, <span class="dt">mean =</span> <span class="dv">10</span>, <span class="dt">sd =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>## [1] 10.72924</code></pre>
<div class="sourceCode" id="cb831"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb831-1"><a href="simulation.html#cb831-1"></a><span class="co"># Normal random variable with mean 10, and standard</span></span>
<span id="cb831-2"><a href="simulation.html#cb831-2"></a><span class="co"># deviation 0.5</span></span>
<span id="cb831-3"><a href="simulation.html#cb831-3"></a><span class="kw">rnorm</span>(<span class="dv">20</span>, <span class="dt">mean =</span> <span class="dv">10</span>, <span class="dt">sd =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>##  [1] 10.057270 10.838536 10.778326 10.028733  9.411916 10.676765  9.968147
##  [8] 10.144458  9.480794 10.211399 10.513579 10.003038  9.445457  9.698689
## [15]  9.477504 10.463018 10.279815 10.548096 10.006456  9.745363</code></pre>
<p>To find the relative probability of observing a particular value for a normal distribution we use <code>dnorm()</code>.</p>
<div class="sourceCode" id="cb833"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb833-1"><a href="simulation.html#cb833-1"></a><span class="co"># Relative probability of observing the value 0.25 for a</span></span>
<span id="cb833-2"><a href="simulation.html#cb833-2"></a><span class="co"># normal random variable with mean 0 and standard devation</span></span>
<span id="cb833-3"><a href="simulation.html#cb833-3"></a><span class="co"># 1</span></span>
<span id="cb833-4"><a href="simulation.html#cb833-4"></a><span class="kw">dnorm</span>(<span class="fl">0.25</span>)</span></code></pre></div>
<pre><code>## [1] 0.3866681</code></pre>
<div class="sourceCode" id="cb835"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb835-1"><a href="simulation.html#cb835-1"></a><span class="co"># Relative probability of observing the value 0.25, -0.5, 2</span></span>
<span id="cb835-2"><a href="simulation.html#cb835-2"></a><span class="co"># for a normal random variable with mean 0 and standard</span></span>
<span id="cb835-3"><a href="simulation.html#cb835-3"></a><span class="co"># devation 1</span></span>
<span id="cb835-4"><a href="simulation.html#cb835-4"></a><span class="kw">dnorm</span>(<span class="kw">c</span>(<span class="fl">0.25</span>, <span class="fl">-0.5</span>, <span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 0.38666812 0.35206533 0.05399097</code></pre>
</div>
</div>
<div id="simulating-a-distribution" class="section level2 hasAnchor">
<h2><span class="header-section-number">15.5</span> Simulating a Distribution<a href="simulation.html#simulating-a-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Recall a binomial random variable <span class="math inline">\(x\)</span>. The random variable denotes the number of “successes”, where there are <span class="math inline">\(n\)</span> trials. Each trial has the same probability of success, <span class="math inline">\(p\)</span>. Each trial is also independent. The probability of failure is <span class="math inline">\((1-p)\)</span>.</p>
<p>The <em>analytical</em> expression for the probability of the random variable having <em>exactly</em> <span class="math inline">\(x\)</span> successes from <span class="math inline">\(n\)</span> trials is below.</p>
<p><span class="math display">\[ p(x) = \frac{n!}{(n-x)!x!} p^x (1-p)^{(n-x)}\]</span></p>
<p>Simulating a distribution is similar to simulating event. However, instead of looking at one probability (say <span class="math inline">\(x\leq3\)</span>) we look at the probability of all possible outcomes of the random variable. This is a very similar process as before, but now we have a lot more outcomes to consider. Below we have a simulation for a binomial random variable where <span class="math inline">\(n= 10\)</span>, and <span class="math inline">\(p = 0.25\)</span>.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-287-1.png" width="672" /></p>
<p>For this example we know what the true probabilities should be because binomial random variables are very well studied. The red lines indicate the truth. How would we know when to stop if we didn’t know the truth? Again, we look for stability. Just as before, we can pick a particular probability (or column in the histogram) and observes when it starts to stabilize.</p>
<p>If we want, we can even go a step further and look at <em>all</em> probabilities (or columns in the histogram) and check when it starts to stabilize. <a href="https://rpgarcia.shinyapps.io/binomial/">To play with this simulation click here</a>.</p>
<p>Caution! Our rule will change based on the situation! Even with the binomial distribution, we may find different stopping rules depending on <span class="math inline">\(n\)</span> and <span class="math inline">\(p\)</span>. Without seeing the “true probability”. Try different values of <span class="math inline">\(n\)</span> and <span class="math inline">\(p\)</span>, and see at what point you think the histogram becomes “stable”. How different where your answers? Did your histogram ever appear stable before it converged to the truth?</p>
</div>
<div id="simulating-a-statisticmean" class="section level2 hasAnchor">
<h2><span class="header-section-number">15.6</span> Simulating a Statistic/Mean<a href="simulation.html#simulating-a-statisticmean" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We already saw a simulation study based on a single probability, and for a distribution. Simulation studies also apply to certain statistics, like the (arithmetic) mean. Just like probabilities, we have two versions of the mean.</p>
<ul>
<li>The theoretical/true/population mean
<span class="math display">\[\mu\]</span></li>
<li>The sample/empirical/estimated mean</li>
</ul>
<p><span class="math display">\[\hat{\mu} \text{   or   } \overline{x}\]</span></p>
<p>Examples</p>
<ul>
<li><p>The average number of cars that go through an intersection an hour.</p></li>
<li><p>The average height of an adult bison (in feet).</p></li>
</ul>
<div class="webnots-information webnots-notification-box">
<p>The FTS applies to means, just like it applies to probabilities of an event. That is, as our sample size increases, are empirical mean should converge to the theoretical mean.</p>
<p><span class="math display">\[\hat{\mu} \rightarrow \mu\]</span></p>
</div>
<p>For example, it well known that mean for the binomial distribution is <span class="math inline">\(np\)</span>, which we can solve with algebra. We can verify our algebra with a simulation study. <a href="https://rpgarcia.shinyapps.io/means_running_binomial/">Click here to see see an example of this in action.</a></p>
</div>
<div id="some-more-tools" class="section level2 hasAnchor">
<h2><span class="header-section-number">15.7</span> Some More Tools<a href="simulation.html#some-more-tools" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="sample" class="section level3 hasAnchor">
<h3><span class="header-section-number">15.7.1</span> sample()<a href="simulation.html#sample" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>sample()</code> function is a powerful tool that can let you create your own unique random sequence. We have already used it several times. You can sample values with replacement, or without replacement. You can also assign certain probabilities to certain events. This is a particularly helpful function for rearranging rows, and for generating a sequence of categorical variables. For example, we can simulate a coin flip.</p>
<div class="sourceCode" id="cb837"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb837-1"><a href="simulation.html#cb837-1"></a><span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;Heads&quot;</span>, <span class="st">&quot;Tails&quot;</span>), <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>))</span></code></pre></div>
<pre><code>## [1] &quot;Tails&quot;</code></pre>
<p>Below is the code for simulating 10 coin flips.</p>
<div class="sourceCode" id="cb839"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb839-1"><a href="simulation.html#cb839-1"></a><span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;Heads&quot;</span>, <span class="st">&quot;Tails&quot;</span>), <span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;Tails&quot; &quot;Heads&quot; &quot;Heads&quot; &quot;Tails&quot; &quot;Heads&quot; &quot;Tails&quot; &quot;Heads&quot; &quot;Heads&quot; &quot;Tails&quot;
## [10] &quot;Tails&quot;</code></pre>
<p>We can set the seed like we did before in order to insure we keep getting the same sample each time we run this code.</p>
<div class="sourceCode" id="cb841"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb841-1"><a href="simulation.html#cb841-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb841-2"><a href="simulation.html#cb841-2"></a><span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;Heads&quot;</span>, <span class="st">&quot;Tails&quot;</span>), <span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;Tails&quot; &quot;Tails&quot; &quot;Heads&quot; &quot;Heads&quot; &quot;Tails&quot; &quot;Heads&quot; &quot;Heads&quot; &quot;Heads&quot; &quot;Heads&quot;
## [10] &quot;Tails&quot;</code></pre>
<p>We can also change the probabilities of observing certain events.</p>
<div class="sourceCode" id="cb843"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb843-1"><a href="simulation.html#cb843-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb843-2"><a href="simulation.html#cb843-2"></a><span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;Heads&quot;</span>, <span class="st">&quot;Tails&quot;</span>), <span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;Tails&quot; &quot;Tails&quot; &quot;Tails&quot; &quot;Heads&quot; &quot;Tails&quot; &quot;Tails&quot; &quot;Heads&quot; &quot;Tails&quot; &quot;Tails&quot;
## [10] &quot;Tails&quot;</code></pre>
</div>
<div id="adding-curves-to-graphs" class="section level3 hasAnchor">
<h3><span class="header-section-number">15.7.2</span> Adding curves to graphs<a href="simulation.html#adding-curves-to-graphs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Often times when generating data or using a real-world data set we might want to see how well a well known distribution fits a particular data set. We can do so by adding the proposed density function on to a histogram which contains the data set of interest. For example, suppose we wish to see if a normal distribution with mean of 3.5 and standard deviation of 1.14 fits the old faithful data set for eruption times. We can add this density function on top and see if it approximately fits the data.</p>
<div class="sourceCode" id="cb845"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb845-1"><a href="simulation.html#cb845-1"></a><span class="kw">hist</span>(faithful<span class="op">$</span>eruptions, <span class="dt">main =</span> <span class="st">&quot;Eruption Times of Old Faithful&quot;</span>,</span>
<span id="cb845-2"><a href="simulation.html#cb845-2"></a>    <span class="dt">xlab =</span> <span class="st">&quot;Time (in minutes)&quot;</span>, <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">7</span>, <span class="dt">by =</span> <span class="fl">0.5</span>),</span>
<span id="cb845-3"><a href="simulation.html#cb845-3"></a>    <span class="dt">freq =</span> <span class="ot">FALSE</span>)</span>
<span id="cb845-4"><a href="simulation.html#cb845-4"></a></span>
<span id="cb845-5"><a href="simulation.html#cb845-5"></a><span class="kw">curve</span>(<span class="kw">dnorm</span>(x, <span class="fl">3.5</span>, <span class="fl">1.14</span>), <span class="dt">add =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-292-1.png" width="672" /></p>
<p>Now lets generate 272 normal random variables with mean 3.5 and standard deviation of 1.14 and see how well are generated data matches the density function.</p>
<div class="sourceCode" id="cb846"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb846-1"><a href="simulation.html#cb846-1"></a>gen_data &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">272</span>, <span class="dt">mean =</span> <span class="fl">3.5</span>, <span class="dt">sd =</span> <span class="fl">1.14</span>)</span>
<span id="cb846-2"><a href="simulation.html#cb846-2"></a></span>
<span id="cb846-3"><a href="simulation.html#cb846-3"></a><span class="kw">hist</span>(gen_data, <span class="dt">main =</span> <span class="st">&quot;Simulated Data&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;X&quot;</span>, <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="fl">0.5</span>,</span>
<span id="cb846-4"><a href="simulation.html#cb846-4"></a>    <span class="dv">7</span>, <span class="dt">by =</span> <span class="fl">0.5</span>), <span class="dt">freq =</span> <span class="ot">FALSE</span>)</span>
<span id="cb846-5"><a href="simulation.html#cb846-5"></a></span>
<span id="cb846-6"><a href="simulation.html#cb846-6"></a><span class="kw">curve</span>(<span class="kw">dnorm</span>(x, <span class="fl">3.5</span>, <span class="fl">1.14</span>), <span class="dt">add =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-293-1.png" width="672" /></p>
<p>We do not see a perfect fit, but this is what happens with random samples. The fit for the simulated data is what we expect approximately if we had a sample with this distribution. It should be approximately the same as the curve, which we see for the simulated data. Our old faithful data is significantly less fitted the simulated data. Thus it appears that the old faithful eruption times is probably not normally distributed with mean 3.5 and standard deviation 1.14. How similar is “similar enough” is not a hard and fast rule, and it is ultimately up to the researcher. The simulated data set gives us a general idea of what is “similar enough”.</p>
<p>Note that the <code>curve()</code> function does not need to be added to graph but can stand alone.</p>
<div class="sourceCode" id="cb847"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb847-1"><a href="simulation.html#cb847-1"></a><span class="kw">curve</span>(<span class="kw">dnorm</span>(x, <span class="fl">3.5</span>, <span class="fl">1.14</span>), <span class="dv">0</span>, <span class="dv">7</span>, <span class="dt">add =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-294-1.png" width="672" /></p>
<p>In addition, we can make our own functions to plot using <code>curve()</code>.</p>
<div class="sourceCode" id="cb848"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb848-1"><a href="simulation.html#cb848-1"></a>my_fun &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb848-2"><a href="simulation.html#cb848-2"></a>    y =<span class="st"> </span>x<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="dv">3</span></span>
<span id="cb848-3"><a href="simulation.html#cb848-3"></a>    <span class="kw">return</span>(y)</span>
<span id="cb848-4"><a href="simulation.html#cb848-4"></a>}</span>
<span id="cb848-5"><a href="simulation.html#cb848-5"></a></span>
<span id="cb848-6"><a href="simulation.html#cb848-6"></a><span class="kw">curve</span>(<span class="kw">my_fun</span>(x), <span class="dv">-10</span>, <span class="dv">10</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-295-1.png" width="672" /></p>
</div>
</div>
<div id="example-fundamental-theorem-of-statistics" class="section level2 hasAnchor">
<h2><span class="header-section-number">15.8</span> Example: Fundamental Theorem of Statistics<a href="simulation.html#example-fundamental-theorem-of-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="more-rigorous-version-of-fts" class="section level3 hasAnchor">
<h3><span class="header-section-number">15.8.1</span> More Rigorous version of FTS<a href="simulation.html#more-rigorous-version-of-fts" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let <span class="math inline">\(X_1, ..., X_n\)</span> be independent and identically distributed random variables with mean and variance, <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2\)</span>. If the sample size is sufficiently large (<span class="math inline">\(n \geq 30\)</span>), the sample mean <span class="math inline">\(\bar{x}\)</span> will tend to follow a normal distribution with mean <span class="math inline">\(\mu\)</span> and standard deviation <span class="math inline">\(\frac{\sigma}{\sqrt{n}}\)</span>.</p>
<p>In other words, for any set of data <span class="math inline">\(X_1, ..., X_n\)</span> that is independent and comes from the same distribution, and that distribution has a finite mean and variance, <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2\)</span>. Then</p>
<p><span class="math display">\[\bar{x} \sim N \left ( \mu, \frac{\sigma}{\sqrt{n}} \right ) \]</span></p>
<p>The distribution above is a <em>sampling distribution</em>. It is the distribution of a <em>sample mean</em>. That is, if we take <span class="math inline">\(k\)</span> samples, and for each sample we calculated the mean, the FTS tells us about the distribution of these means (<span class="math inline">\(\bar{x}_1, \dots, \bar{x}_k\)</span>).</p>
</div>
<div id="assumption-violations-of-fts" class="section level3 hasAnchor">
<h3><span class="header-section-number">15.8.2</span> Assumption Violations of FTS<a href="simulation.html#assumption-violations-of-fts" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The FTS has a few key assumptions. Some of these assumptions are fairly easy to meet, and others are more susceptible to being violated. For example, typically it is reasonable to assume that mean and variance are finite. Other assumptions are easier to violate, and the consequences of violating these assumptions vary greatly. Sometimes we may have data that comes from a mix of multiple distributions, this violate the assumption that data is identically distributed. Another assumption violation could be independence. For example, in time series data we typically observe a random variable over a sequence of time and measure it repeatedly. This would violate the independence assumption because earlier observations are typically related to future observations. Another assumption that is often violated is the minimum sample size. The FTS says we need at least 30 observations, or else we should use the t-distribution instead. Historically this is usually not a very big problem. The requirement that our sample size is at least 30 is a “rule of thumb” and not based on rigorous statistical theory.</p>
<p>Below are a summary of these assumptions restated:</p>
<ul>
<li><p>All our observations are independent, and have the same distribution (come from same population)</p></li>
<li><p>Sample size is greater than 30 (<span class="math inline">\(n\geq 30\)</span>)</p></li>
<li><p>The mean and the variance of the distribution the data comes from are finite (<span class="math inline">\(|\mu|&lt; \infty, |\sigma^2|&lt; \infty\)</span>)</p></li>
</ul>
<p>Once we have verified these assumptions, we still need to determine what the mean (<span class="math inline">\(\mu\)</span>) and variance (<span class="math inline">\(\sigma^2\)</span>) are. If we know that our distribution is one of the really common ones above, then this task becomes much eaiser.</p>
</div>
<div id="the-data" class="section level3 hasAnchor">
<h3><span class="header-section-number">15.8.3</span> The Data<a href="simulation.html#the-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We will see how well the FTS theorem applies to a data set that has a uniform distribution. That is, say we have a sample of 50 observations which we believe are all uniformly distributed between -5 and 5. We want to determine if the mean of a sample of this type would be normally distributed according to the FTS. To do so, we simulate a sample of this type 10,000 times and assess if it matches the FTS results.</p>
<div class="sourceCode" id="cb849"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb849-1"><a href="simulation.html#cb849-1"></a><span class="co"># Simulate a sample of 50 observations that are uniformly</span></span>
<span id="cb849-2"><a href="simulation.html#cb849-2"></a><span class="co"># distributed</span></span>
<span id="cb849-3"><a href="simulation.html#cb849-3"></a>gen_unif_mean =<span class="st"> </span><span class="cf">function</span>(the_min, the_max) {</span>
<span id="cb849-4"><a href="simulation.html#cb849-4"></a>    gen_data =<span class="st"> </span><span class="kw">runif</span>(<span class="dv">50</span>, the_min, the_max)</span>
<span id="cb849-5"><a href="simulation.html#cb849-5"></a>    the_mean =<span class="st"> </span><span class="kw">mean</span>(gen_data)</span>
<span id="cb849-6"><a href="simulation.html#cb849-6"></a>    the_parameters =<span class="st"> </span><span class="kw">c</span>(the_min, the_max)</span>
<span id="cb849-7"><a href="simulation.html#cb849-7"></a>    results =<span class="st"> </span><span class="kw">list</span>(the_mean, the_parameters)</span>
<span id="cb849-8"><a href="simulation.html#cb849-8"></a>    <span class="kw">names</span>(results) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;mean&quot;</span>, <span class="st">&quot;parameters&quot;</span>)</span>
<span id="cb849-9"><a href="simulation.html#cb849-9"></a>    <span class="kw">return</span>(results)</span>
<span id="cb849-10"><a href="simulation.html#cb849-10"></a>}</span>
<span id="cb849-11"><a href="simulation.html#cb849-11"></a></span>
<span id="cb849-12"><a href="simulation.html#cb849-12"></a><span class="co"># Simulate 10000 samples, each of size 50, where the</span></span>
<span id="cb849-13"><a href="simulation.html#cb849-13"></a><span class="co"># minumum value is -5 And the maximum value is 5</span></span>
<span id="cb849-14"><a href="simulation.html#cb849-14"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb849-15"><a href="simulation.html#cb849-15"></a>sim_means &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">10000</span>, <span class="kw">gen_unif_mean</span>(<span class="dt">the_min =</span> <span class="dv">-5</span>, <span class="dt">the_max =</span> <span class="dv">5</span>)<span class="op">$</span>mean)</span>
<span id="cb849-16"><a href="simulation.html#cb849-16"></a></span>
<span id="cb849-17"><a href="simulation.html#cb849-17"></a></span>
<span id="cb849-18"><a href="simulation.html#cb849-18"></a><span class="co"># histogram of results</span></span>
<span id="cb849-19"><a href="simulation.html#cb849-19"></a><span class="kw">hist</span>(sim_means, <span class="dt">freq =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-296-1.png" width="672" /></p>
<p>To add a curve to the graph we need to know the mean and the standard deviation of the data we generated. For a uniform distribution with a minimum of -5 and a maximum of 5, the mean is 0 and the standard deviation is <span class="math inline">\(10/\sqrt{12} \approx 2.89\)</span>. Thus according to FTS, we expect our histogram above to correspond to a normal density with mean 0 and standard deviation <span class="math inline">\(2.89/\sqrt{50} \approx 0.41\)</span>.</p>
<div class="sourceCode" id="cb850"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb850-1"><a href="simulation.html#cb850-1"></a><span class="co"># histogram of results</span></span>
<span id="cb850-2"><a href="simulation.html#cb850-2"></a><span class="kw">hist</span>(sim_means, <span class="dt">freq =</span> <span class="ot">FALSE</span>)</span>
<span id="cb850-3"><a href="simulation.html#cb850-3"></a></span>
<span id="cb850-4"><a href="simulation.html#cb850-4"></a><span class="co"># Add normal curve according to FTS</span></span>
<span id="cb850-5"><a href="simulation.html#cb850-5"></a><span class="kw">curve</span>(<span class="kw">dnorm</span>(x, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="fl">0.41</span>), <span class="dt">add =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-297-1.png" width="672" /></p>
</div>
</div>
<div id="simulation-stuides-for-statistical-methods" class="section level2 hasAnchor">
<h2><span class="header-section-number">15.9</span> Simulation Stuides for Statistical Methods<a href="simulation.html#simulation-stuides-for-statistical-methods" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Simulation methods are also used as impartial way to check our theories.</p>
<ul>
<li><p>Does the central limit theorem really work?</p></li>
<li><p>Does are method for finding outliers seem good?</p></li>
<li><p>Do our confidence intervals make sense?</p></li>
</ul>
<p>Simulation studies are useful for more difficult things to calculate or learn about.</p>
<p>For example, suppose you want to calculate a 95% confidence interval for the heights of all college students. Our theory on confidence intervals says that we expect that a 95% confidence interval will capture the true mean about 95% of the time. If we simply go out and take a sample of data from “real-life” and then calculate the a confidence interval we have no idea if that confidence interval captures the truth because the true average height of all college students is unknown! It is not feasible to sample every college students, so we will never know if the true mean actually falls within our interval. Furthermore, in this example we only calculated one confidence interval. If we did know the true mean then our results would simply indicate that the confidence interval captured the mean or not, but nothing about the <em>rate</em> that confidence intervals capture the mean, which should be 95%. What we can do instead is simulate this process. We can randomly generate data that has a true mean of <span class="math inline">\(\mu\)</span> using a computer. Then we can estimate a 95% confidence interval using the appropriate methods and see if this confidence interval contains <span class="math inline">\(\mu\)</span>. We then can repeat this process as many times as we would like because we are using a computer, which makes the process much simpler. If our theory about confidence intervals is correct we would expect that 95% of our confidence intervals captured the true mean (<span class="math inline">\(\mu\)</span>), and the rest did not.</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-OpenIntro">
<p>Diez, David, Mine Cetinkaya-Rundel, and Christopher D Barr. 2020. <em>OpenIntro Statistics, Fourth Edition</em>. OpenIntro. <a href="https://www.openintro.org/book/os/">https://www.openintro.org/book/os/</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="loops.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="tidyverse.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/15-simulation.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
